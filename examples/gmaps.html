<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <style type="text/css">
      #map-canvas {
        width: 600px;
        height: 400px;
      }
      .float-left {
        float: left;
        margin-right: 10px;
      }
      .float-right {
        float: right;
      }
    </style>
    <script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
    <script type="text/javascript"
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDxTEbJsXwGRW4zDj8fpVsenDMMQGhZhUU&sensor=false">
    </script>
    <script data-main="initialize" src="../externals/require.js"></script>
    <script type="text/javascript">
      var NS = 'gmaps';
      var BASE = 'GoogleRoadMap';
      function LayerRepository(aeris) {
        this.aeris = aeris;
        this.layers = {};
      }
      LayerRepository.prototype.getLayer = function(layer) {
        var layer_ = this.layers[layer];
        if (!layer_) {
          layer_ = this.layers[layer] = new this.aeris.maps.layers[layer]();
        }
        return layer_;
      };
      
      function initialize() {
        require(['../lib/config'], function() {
          require.config({
            config: {
              aeris: {
                apiId: 'ezHWL0MiLsxwlN2ik8U4c',
                apiSecret: 'uCDMeSj91lBfIKCmeQkpeZjsAwUUQJHuKesCvqTm'
              }
            }
          });
          require(["aeris/maps/" + NS], function(aeris) {
        
            var layerRepo = new LayerRepository(aeris);
        
            var map = new aeris.maps[NS].Map("map-canvas", {
              baseLayer: layerRepo.getLayer(BASE),
              center: [44.98, -93.2636],
              zoom: 4
            });
        
            // Base layer
        
            var $baseLayer = $("#base-layer");
            $baseLayer.change(function() {
              var layer = layerRepo.getLayer($baseLayer.val());
              map.layers.setBaseLayer(layer);
            });
        
            // Radar
        
            var radar = new aeris.maps.layers.AerisRadar();
            radar.setMap(map);
            radar.autoUpdate();
        
            var $radarVisibility = $("#radar-visibility");
            $radarVisibility.change(function() {
              radar[$radarVisibility.val()]();
            });
        
            var $radarOpacity = $("#radar-opacity");
            $radarOpacity.change(function() {
              radar.setOpacity($radarOpacity.val());
            });

            var $radarOn = $('#radar-on');
            $radarOn.change(function() {
              if ($radarOn.is(':checked')) {
                radar.setMap(map);
                $radarVisibility.prop('disabled', false);
                $radarOpacity.prop('disabled', false);
              } else {
                radar.remove();
                $radarVisibility.prop('disabled', true);
                $radarOpacity.prop('disabled', true);
              }
            });
        
            // Satellite
        
            var satellite = new aeris.maps.layers.AerisSatellite();
            satellite.setMap(map);
            satellite.autoUpdate();
        
            var $satelliteVisibility = $("#satellite-visibility");
            $satelliteVisibility.change(function() {
              satellite[$satelliteVisibility.val()]();
            });
        
            var $satelliteOpacity = $("#satellite-opacity");
            $satelliteOpacity.change(function() {
              satellite.setOpacity($satelliteOpacity.val());
            });

            var $satelliteOn = $('#satellite-on');
            $satelliteOn.change(function() {
              if ($satelliteOn.is(':checked')) {
                satellite.setMap(map);
                $satelliteVisibility.prop('disabled', false);
                $satelliteOpacity.prop('disabled', false);
              } else {
                satellite.remove();;
                $satelliteVisibility.prop('disabled', true);
                $satelliteOpacity.prop('disabled', true);
              }
            });
        
            // Advisories
        
            var advisories = new aeris.maps.layers.AerisAdvisories();
            advisories.setMap(map);
            advisories.autoUpdate();
        
            var $advisoriesVisibility = $("#advisories-visibility");
            $advisoriesVisibility.change(function() {
              advisories[$advisoriesVisibility.val()]();
            });
        
            var $advisoriesOpacity = $("#advisories-opacity");
            $advisoriesOpacity.change(function() {
              advisories.setOpacity($advisoriesOpacity.val());
            });

            var $advisoriesOn = $('#advisories-on');
            $advisoriesOn.change(function() {
              if ($advisoriesOn.is(':checked')) {
                advisories.setMap(map);
                $advisoriesVisibility.prop('disabled', false);
                $advisoriesOpacity.prop('disabled', false);
              } else {
                advisories.remove();
                $advisoriesVisibility.prop('disabled', true);
                $advisoriesOpacity.prop('disabled', true);
              }
            });
        
            // Animate
        
            var anim = new aeris.maps.animations.AnimationSync(
              [radar, satellite]);
        
            var $animStart = $("#anim-start");
            $animStart.click(function() {
              anim.start();
              return false;
            });
        
            var $animPause = $("#anim-pause");
            $animPause.click(function() {
              anim.pause();
              return false;
            });
        
            var $animStop = $("#anim-stop");
            $animStop.click(function() {
              anim.stop();
              return false;
            });
        
            var $animPrev = $("#anim-prev");
            $animPrev.click(function() {
              anim.previous();
              return false;
            });
        
            var $animNext = $("#anim-next");
            $animNext.click(function() {
              anim.next();
              return false;
            });
          });
        });
      }
    </script>
  </head>
  <body>
    <div id="map-canvas" class="float-left"></div>
    <div class="float-left">
      <h3>Base Layer</h3>
      <div>
        <select id="base-layer">
          <option value="GoogleRoadMap" selected="selected">Google Street Map</option>
          <option value="GoogleSatellite">Google Satellite</option>
          <option value="GoogleTerrain">Google Terrain</option>
          <option value="GoogleHybrid">Google Hybrid</option>
          <option value="OSM">OpenStreetMap</option>
        </select>
      </div>

      <h3>Radar</h3>
      <div>
        <input type="checkbox" checked="checked" id="radar-on">
        <label for="radar-on">On</label>
      </div>
      <div>
        <label for="radar-visibility">Visibility:</label>
        <select id="radar-visibility">
          <option value="show" selected="selected">Show</option>
          <option value="hide">Hide</option>
        </select>
      </div>
      <div>
        <label for="radar-opacity">Opacity:</label>
        <select id="radar-opacity">
          <option value="1" selected="selected">100%</option>
          <option value="0.9">90%</option>
          <option value="0.8">80%</option>
          <option value="0.7">70%</option>
          <option value="0.6">60%</option>
          <option value="0.5">50%</option>
          <option value="0.4">40%</option>
          <option value="0.3">30%</option>
          <option value="0.2">20%</option>
          <option value="0.1">10%</option>
          <option value="0">0%</option>
        </select>
      </div>

      <h3>Satellite</h3>
      <div>
        <input type="checkbox" checked="checked" id="satellite-on">
        <label for="satellite-on">On</label>
      </div>
      <div>
        <label for="satellite-visibility">Visibility:</label>
        <select id="satellite-visibility">
          <option value="show" selected="selected">Show</option>
          <option value="hide">Hide</option>
        </select>
      </div>
      <div>
        <label for="satellite-opacity">Opacity:</label>
        <select id="satellite-opacity">
          <option value="1" selected="selected">100%</option>
          <option value="0.9">90%</option>
          <option value="0.8">80%</option>
          <option value="0.7">70%</option>
          <option value="0.6">60%</option>
          <option value="0.5">50%</option>
          <option value="0.4">40%</option>
          <option value="0.3">30%</option>
          <option value="0.2">20%</option>
          <option value="0.1">10%</option>
          <option value="0">0%</option>
        </select>
      </div>

      <h3>Advisories</h3>
      <div>
        <input type="checkbox" checked="checked" id="advisories-on">
        <label for="advisories-on">On</label>
      </div>
      <div>
        <label for="advisories-visibility">Visibility:</label>
        <select id="advisories-visibility">
          <option value="show" selected="selected">Show</option>
          <option value="hide">Hide</option>
        </select>
      </div>
      <div>
        <label for="advisories-opacity">Opacity:</label>
        <select id="advisories-opacity">
          <option value="1" selected="selected">100%</option>
          <option value="0.9">90%</option>
          <option value="0.8">80%</option>
          <option value="0.7">70%</option>
          <option value="0.6">60%</option>
          <option value="0.5">50%</option>
          <option value="0.4">40%</option>
          <option value="0.3">30%</option>
          <option value="0.2">20%</option>
          <option value="0.1">10%</option>
          <option value="0">0%</option>
        </select>
      </div>
    </div>
    <div class="float-left">
      <h3>Animation</h3>
      <div>
        <a href="#" id="anim-start">Start</a> &#160;|&#160;
        <a href="#" id="anim-pause">Pause</a> &#160;|&#160;
        <a href="#" id="anim-stop">Stop</a>
      </div>
      <div>
        <a href="#" id="anim-prev">Previous</a> &#160;|&#160;
        <a href="#" id="anim-next">Next</a>
      </div>
    </div>
  </body>
</html>


